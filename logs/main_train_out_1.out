

-------------------------------
0) Setting of the environment folder : experiment_features_cases_state_2020-06-01_2020-06-27



BEGINNING OF THE TRAINING
#########################

-------------------------
1) Loading of the data :

    target : cases
    region : state
    
    Chosen cutoffs: 

        - training_agg_cutoff : 2020-06-01
        - training_cutoff : 2020-05-16
        - validation_cutoff : 2020-06-27

    Additional information >>>

        - features MDP : 
            {'days_avg': 3, 'horizon': 8, 'n_iter': 100, 'n_folds_cv': 4, 'clustering_distance_threshold': 0.1, 'splitting_threshold': 0.0, 'classification_algorithm': 'DecisionTreeClassifier', 'clustering_algorithm': 'Agglomerative', 'n_clusters': None, 'action_thresh': ([], 0), 'features_list': ['cases_pct3', 'cases_pct5', 'cases_pct30', 'temperature', 'temperature_7'], 'verbose': 1, 'n_jobs': -1, 'date_colname': 'date', 'target_colname': 'cases', 'region_colname': 'state', 'random_state': 42, 'keep_first': True, 'save': False, 'plot': False, 'savepath': '', 'region_exceptions': None}

    Loading datasets : running ...


pop 48
Training set contains 48 state.
pop 48
Training set contains 48 state.
pop 48
Training set contains 48 state.

    Loading datasets : done.




-------------------------------
2) Training and Loading models (TRAIN) :

    Training and predictions : running ...



    (26/02/2021 17:31:40) Predictions Bi-LSTM : running ...
[['Alabama', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin']]
day 0
day 1
day 2
day 3
day 4
day 5
day 6
day 7
day 8
day 9
day 10
day 11
day 12
day 13
day 14
day 15
day 16
day 17
day 18
day 19
day 20
day 21
day 22
day 23
day 24
day 25
day 26

    (26/02/2021 17:32:36) Predictions Bi-LSTM : done.

    (26/02/2021 17:32:36) Predictions MDP : running ...
The region 'Wyoming' is not in the trained region set

    (26/02/2021 17:32:40) Predictions MDP : done.

    Training and predictions (~AGG) : done.
    
    

    -------------------------------
    2-bis) Training and Loading models (AGG) :

        Training and predictions : running ...

    

        (26/02/2021 17:32:40) Training Bi-LSTM (AGG) : running ...
k is:  1
k is:  2
k is:  3
k is:  4
k is:  5
k is:  6
k is:  7
k is:  8
k is:  9
k is:  10
k is:  11
k is:  12
k is:  13
k is:  14
k is:  15
k is:  16
k is:  17
k is:  18
k is:  19
k is:  20
k is:  21
k is:  22
k is:  23
k is:  24
k is:  25
k is:  26
k is:  27
k is:  28
k is:  29
k is:  30
k is:  31
k is:  32
k is:  33
k is:  34
k is:  35
k is:  36
k is:  37
k is:  38
k is:  39
k is:  40
k is:  41
k is:  42
Optimal value of clusters is:  7
[['Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'Wisconsin']]
          state       date  cases  temperature  GrowthRate
0       Arizona 2020-04-10   3112    -0.804115         NaN
1       Arizona 2020-04-11   3393    -0.981115    0.090296
2       Arizona 2020-04-12   3542    -0.766187    0.043914
3       Arizona 2020-04-13   3705    -1.271900    0.046019
4       Arizona 2020-04-14   3809    -1.398328    0.028070
...         ...        ...    ...          ...         ...
1750  Wisconsin 2020-05-12  10611    -0.665044    0.018526
1751  Wisconsin 2020-05-13  10902     0.118811    0.027424
1752  Wisconsin 2020-05-14  11275     0.675096    0.034214
1753  Wisconsin 2020-05-15  11685     0.396953    0.036364
1754  Wisconsin 2020-05-16  12187     0.295811    0.042961

[1755 rows x 5 columns]
Epoch 1/100
1/9 [==>...........................] - ETA: 0s - loss: 0.0017 - mse: 0.00173/9 [=========>....................] - ETA: 0s - loss: 0.0018 - mse: 0.00186/9 [===================>..........] - ETA: 0s - loss: 0.0021 - mse: 0.00219/9 [==============================] - ETA: 0s - loss: 0.0021 - mse: 0.0021
Epoch 00001: val_loss improved from inf to 0.00122, saving model to ../models/experiment_features_cases_state_2020-06-01_2020-06-27/bidir_lstm_2.h5
9/9 [==============================] - 1s 144ms/step - loss: 0.0021 - mse: 0.0021 - val_loss: 0.0012 - val_mse: 0.0012
Epoch 2/100
1/9 [==>...........................] - ETA: 0s - loss: 0.0026 - mse: 0.00264/9 [============>.................] - ETA: 0s - loss: 0.0021 - mse: 0.00217/9 [======================>.......] - ETA: 0s - loss: 0.0022 - mse: 0.0022
Epoch 00002: val_loss did not improve from 0.00122
9/9 [==============================] - 1s 87ms/step - loss: 0.0021 - mse: 0.0021 - val_loss: 0.0012 - val_mse: 0.0012
Epoch 00002: early stopping
model_2
ave
100.0
['Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'Wisconsin']
  1/132 [..............................] - ETA: 0s - loss: 0.0011 - mse: 0.0011  4/132 [..............................] - ETA: 2s - loss: 0.0012 - mse: 0.0012  7/132 [>.............................] - ETA: 2s - loss: 0.0012 - mse: 0.0012 10/132 [=>............................] - ETA: 2s - loss: 0.0012 - mse: 0.0012 13/132 [=>............................] - ETA: 2s - loss: 0.0013 - mse: 0.0013 16/132 [==>...........................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 19/132 [===>..........................] - ETA: 2s - loss: 0.0015 - mse: 0.0015 22/132 [====>.........................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 25/132 [====>.........................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 28/132 [=====>........................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 30/132 [=====>........................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 33/132 [======>.......................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 36/132 [=======>......................] - ETA: 2s - loss: 0.0014 - mse: 0.0014 39/132 [=======>......................] - ETA: 2s - loss: 0.0013 - mse: 0.0013 42/132 [========>.....................] - ETA: 2s - loss: 0.0013 - mse: 0.0013 45/132 [=========>....................] - ETA: 1s - loss: 0.0013 - mse: 0.0013 48/132 [=========>....................] - ETA: 1s - loss: 0.0014 - mse: 0.0014 51/132 [==========>...................] - ETA: 1s - loss: 0.0014 - mse: 0.0014 54/132 [===========>..................] - ETA: 1s - loss: 0.0014 - mse: 0.0014 56/132 [===========>..................] - ETA: 1s - loss: 0.0014 - mse: 0.0014 59/132 [============>.................] - ETA: 1s - loss: 0.0014 - mse: 0.0014 62/132 [=============>................] - ETA: 1s - loss: 0.0014 - mse: 0.0014 65/132 [=============>................] - ETA: 1s - loss: 0.0013 - mse: 0.0013 67/132 [==============>...............] - ETA: 1s - loss: 0.0013 - mse: 0.0013 70/132 [==============>...............] - ETA: 1s - loss: 0.0013 - mse: 0.0013 73/132 [===============>..............] - ETA: 1s - loss: 0.0013 - mse: 0.0013 76/132 [================>.............] - ETA: 1s - loss: 0.0013 - mse: 0.0013 79/132 [================>.............] - ETA: 1s - loss: 0.0013 - mse: 0.0013 82/132 [=================>............] - ETA: 1s - loss: 0.0013 - mse: 0.0013 85/132 [==================>...........] - ETA: 1s - loss: 0.0013 - mse: 0.0013 88/132 [===================>..........] - ETA: 0s - loss: 0.0013 - mse: 0.0013 91/132 [===================>..........] - ETA: 0s - loss: 0.0013 - mse: 0.0013 94/132 [====================>.........] - ETA: 0s - loss: 0.0013 - mse: 0.0013 97/132 [=====================>........] - ETA: 0s - loss: 0.0013 - mse: 0.0013100/132 [=====================>........] - ETA: 0s - loss: 0.0013 - mse: 0.0013103/132 [======================>.......] - ETA: 0s - loss: 0.0013 - mse: 0.0013106/132 [=======================>......] - ETA: 0s - loss: 0.0013 - mse: 0.0013109/132 [=======================>......] - ETA: 0s - loss: 0.0013 - mse: 0.0013111/132 [========================>.....] - ETA: 0s - loss: 0.0013 - mse: 0.0013114/132 [========================>.....] - ETA: 0s - loss: 0.0013 - mse: 0.0013117/132 [=========================>....] - ETA: 0s - loss: 0.0013 - mse: 0.0013120/132 [==========================>...] - ETA: 0s - loss: 0.0013 - mse: 0.0013123/132 [==========================>...] - ETA: 0s - loss: 0.0013 - mse: 0.0013126/132 [===========================>..] - ETA: 0s - loss: 0.0013 - mse: 0.0013129/132 [============================>.] - ETA: 0s - loss: 0.0013 - mse: 0.0013132/132 [==============================] - ETA: 0s - loss: 0.0013 - mse: 0.0013132/132 [==============================] - 3s 23ms/step - loss: 0.0013 - mse: 0.0013

        (26/02/2021 17:33:47) Training Bi-LSTM (AGG) : done.

        bi-lstm model saved.

        (26/02/2021 17:33:47) Predictions Bi-LSTM (AGG) : running ...
[['Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'Wisconsin']]
day 0
day 1
day 2
day 3
day 4
day 5
day 6
day 7
day 8
day 9
day 10
day 11
day 12
day 13
day 14
day 15
day 16

        (26/02/2021 17:34:20) Predictions Bi-LSTM (AGG) : done.

        (26/02/2021 17:34:20) Training MDP (AGG) : running ...
